<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>residualffn_modules &mdash; sensAI  documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="seq" href="../seq.html" />
    <link rel="prev" title="residualffn_models" href="residualffn_models.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            sensAI
          </a>
              <div class="version">
                1.2.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Guides and Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../intro.html">Introduction to sensAI: Supervised Learning with VectorModels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../neural_networks.html">Neural Networks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../index.html">Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../catboost.html">catboost</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../clustering.html">clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../columngen.html">columngen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data.html">data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../data_transformation.html">data_transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../distance_metric.html">distance_metric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../ensemble.html">ensemble</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../evaluation.html">evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../feature_importance.html">feature_importance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../feature_selection.html">feature_selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../featuregen.html">featuregen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../geoanalytics.html">geoanalytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../hyperopt.html">hyperopt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../lightgbm.html">lightgbm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../local_search.html">local_search</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../minizinc.html">minizinc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../multi_model.html">multi_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../naive_bayes.html">naive_bayes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nearest_neighbors.html">nearest_neighbors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../normalisation.html">normalisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../pytorch_lightning.html">pytorch_lightning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../sklearn.html">sklearn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../sklearn_quantile.html">sklearn_quantile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensor_model.html">tensor_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../tensorflow.html">tensorflow</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../torch.html">torch</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../torch_base.html">torch_base</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../torch_data.html">torch_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../torch_enums.html">torch_enums</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../torch_eval_util.html">torch_eval_util</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../torch_models.html">torch_models</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../lstnet.html">lstnet</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mlp.html">mlp</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="../residualffn.html">residualffn</a></li>
<li class="toctree-l4"><a class="reference internal" href="../seq.html">seq</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../torch_modules.html">torch_modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../torch_opt.html">torch_opt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../torchtext.html">torchtext</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../tracking.html">tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../util.html">util</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vector_model.html">vector_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../vectoriser.html">vectoriser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../xgboost.html">xgboost</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">sensAI</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Modules</a></li>
          <li class="breadcrumb-item"><a href="../../../torch.html">torch</a></li>
          <li class="breadcrumb-item"><a href="../../torch_models.html">torch_models</a></li>
          <li class="breadcrumb-item"><a href="../residualffn.html">residualffn</a></li>
      <li class="breadcrumb-item active">residualffn_modules</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/sensai/torch/torch_models/residualffn/residualffn_modules.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-sensai.torch.torch_models.residualffn.residualffn_modules">
<span id="residualffn-modules"></span><h1>residualffn_modules<a class="headerlink" href="#module-sensai.torch.torch_models.residualffn.residualffn_modules" title="Permalink to this headline">ÔÉÅ</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sensai.torch.torch_models.residualffn.residualffn_modules.ResidualFeedForwardNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ResidualFeedForwardNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/jambit/sensAI/blob/master/src/sensai/torch/torch_models/residualffn/residualffn_modules.py#L8"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sensai.torch.torch_models.residualffn.residualffn_modules.ResidualFeedForwardNetwork" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
<p>A feed-forward network consisting of a fully connected input layer, a configurable number of residual blocks and a
fully connected output layer. Similar architecture are described in e.g. [1] and [2] and are all inspired by
ResNet [3]. Each residual block consists of two fully connected layers with (optionally) batch normalisation and
dropout, which can all be bypassed by a so-called skip connection. The skip path and the non-skip path are added as
the last step within each block.</p>
<p>More precisely, the non-skip path consists of the following layers:
batch normalization -&gt; ReLU, dropout -&gt; fully-connected -&gt; batch normalization -&gt; ReLU, dropout -&gt; fully-connected
The use of the activation function before the connected layers is called ‚Äúpre-activation‚Äù [4].</p>
<p>The skip path does nothing for the case where the input dimension of the block equals the output dimension. If these
dimensions are different, the skip-path consists of a fully-connected layer, but with no activation, normalization,
or dropout.</p>
<p>Within each block, the dimension can be reduced by a certain factor. This is known as ‚Äúbottleneck‚Äù design. It has
been shown for the original ResNet, that such a bottleneck design can reduce the number of parameters of the models
and improve the training behaviour without compromising the results.</p>
<p>Batch normalisation can be deactivated, but normally it improves the results, since it not only provides some
regularisation, but also normalises the distribution of the inputs of each layer and therefore addresses the problem
of ‚Äúinternal covariate shift‚Äù[5]. The mechanism behind this is not yet fully understood (see e.g. the Wikipedia
article on batch normalisation for further references).
Our batch normalisation module will normalise batches per dimension C in 2D tensors of shape (N, C) or 3D tensors
of shape (N, L, C).</p>
<p class="rubric">References</p>
<ul class="simple">
<li><p>[1] Chen, Dongwei et al. ‚ÄúDeep Residual Learning for Nonlinear Regression.‚Äù
Entropy 22, no. 2 (February 2020): 193. <a class="reference external" href="https://doi.org/10.3390/e22020193">https://doi.org/10.3390/e22020193</a>.</p></li>
<li><p>[2] Kiprijanovska, et al. ‚ÄúHousEEC: Day-Ahead Household Electrical Energy Consumption Forecasting Using Deep Learning.‚Äù
Energies 13, no. 10 (January 2020): 2672. <a class="reference external" href="https://doi.org/10.3390/en13102672">https://doi.org/10.3390/en13102672</a>.</p></li>
<li><p>[3] He, Kaiming, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. ‚ÄúDeep Residual Learning for Image Recognition.‚Äù
ArXiv:1512.03385 [Cs], December 10, 2015. http://arxiv.org/abs/1512.03385.</p></li>
<li><p>[4] He, Kaiming, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. ‚ÄúIdentity Mappings in Deep Residual Networks.‚Äù
ArXiv:1603.05027 [Cs], July 25, 2016. http://arxiv.org/abs/1603.05027.</p></li>
<li><p>[5] Ioffe, Sergey, and Christian Szegedy. ‚ÄúBatch Normalization: Accelerating Deep Network Training by Reducing
Internal Covariate Shift.‚Äù ArXiv:1502.03167 [Cs], March 2, 2015. http://arxiv.org/abs/1502.03167.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="sensai.torch.torch_models.residualffn.residualffn_modules.ResidualFeedForwardNetwork.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bottleneck_dimension_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_dropout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_batch_normalisation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sensai.torch.torch_models.residualffn.residualffn_modules.ResidualFeedForwardNetwork.__init__" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dim</strong> ‚Äì the input dimension of the model</p></li>
<li><p><strong>output_dim</strong> ‚Äì the output dimension of the model</p></li>
<li><p><strong>hidden_dims</strong> ‚Äì a list of dimensions; for each list item, a residual block with the corresponding dimension
is created</p></li>
<li><p><strong>bottleneck_dimension_factor</strong> ‚Äì an optional factor that specifies the hidden dimension within each block</p></li>
<li><p><strong>p_dropout</strong> ‚Äì the dropout probability to use during training (defaults to None for no dropout)</p></li>
<li><p><strong>use_batch_normalisation</strong> ‚Äì whether to use batch normalisation (defaults to True)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sensai.torch.torch_models.residualffn.residualffn_modules.ResidualFeedForwardNetwork.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sensai.torch.torch_models.residualffn.residualffn_modules.ResidualFeedForwardNetwork.forward" title="Permalink to this definition">ÔÉÅ</a></dt>
<dd></dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="residualffn_models.html" class="btn btn-neutral float-left" title="residualffn_models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../seq.html" class="btn btn-neutral float-right" title="seq" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>